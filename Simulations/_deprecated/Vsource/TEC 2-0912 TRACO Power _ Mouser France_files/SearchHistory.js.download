var sh_search_bar=$("#search-bar"),sh_header_search_box=$(".headerSearchBox"),search_history={max_input_length:50,arrow_key_pressed:!1,printable_key_pressed:!1,enter_key_pressed:!1,backspace_key_pressed:!1,search_box_clicked:!1,enter_on_textbox_pressed:!1,initial_search_box_click:!1,initial_arrow_key_press:!1,row_clicked:!1,key:shIsEmptyOrNull($("html").attr("lang"))==!0?"searchHistory_en":"searchHistory_"+$("html").attr("lang"),last_active_row:null,category_val:"",category:"",holder:$('<div class="as-results" id="searchHistoryHolder"></div>'),ul:$('<ul class="as-list" style="padding:0px;width:100%;border:0;margin-top:-0.5px"></ul>'),header:$('<li class="header"><span class="AS-header"></span></li>'),storage:{searchTerm:[]},rand_nums:[],loadSearchHistory:function(){try{localStorage.getItem(search_history.key)!=null?search_history.storage=JSON.parse(localStorage.getItem(search_history.key)):localStorage.setItem(search_history.key,JSON.stringify(search_history.storage))}catch{}},populateSearchHistoryList:function(){try{var e,s,o,i,n=$('<button type="button" class="close remove-search-item"><i class="fa fa-times" aria-hidden="true"></i></button>'),t=search_history.storage.searchTerm;search_history.rand_nums=shGenerateRandNums(t.length);for(e=t.length-1;e>=0;e--)s=search_history.rand_nums[e],n.attr("id","removeSearchItem"+s),n.attr("aria-label","Remove "+t[e]),o=$('<li class="as-result-item" style="padding-top:4px;padding-bottom:4px;" id="searchLi'+s+'"><a class="link" href="javascript:populateSearchLink()" tabindex="0">'+t[e]+"</a>"+n[0].outerHTML+"</li>"),search_history.header.after(o);i=$("#search-bar").width()-40,$("[id^='searchLi'] a",search_history.holder).css({display:"inline-block",width:i+"px",overflow:"hidden","text-overflow":"ellipsis"})}catch{}},addToSearchHistory:function(e,t){try{if(!shIsEmptyOrNull(e)&&e.length<=search_history.max_input_length){for(var i,n=ScrubEncodeSearchTerm(e),o=-1,s=0;s<search_history.storage.searchTerm.length;s++)if(shEqualsIgnoreCase(search_history.storage.searchTerm[s],e)||shEqualsIgnoreCase(search_history.storage.searchTerm[s],n)){o=s;break}for(o>-1&&(search_history.storage.searchTerm.splice(o,1),i=o+1,t&&!search_history.arrow_key_pressed&&search_history.printable_key_pressed&&(search_history.category_val=$("input[name=ScopeSelection]",sh_search_bar).val(),search_history.category=sh_search_bar.find("[data-value='"+search_history.category_val+"']").attr("eng"),GaEvent("Search History Bypassed",search_history.category+"|"+n,i.toString(),i)),t&&search_history.arrow_key_pressed&&!search_history.printable_key_pressed&&GaEvent("Search History Prefill Search",n,i.toString(),i));search_history.storage.searchTerm.length>=MAX_HISTORY_SIZE;)search_history.storage.searchTerm.pop();!shIsEmptyOrNull(n)&&n.length&&(search_history.storage.searchTerm.unshift(n),localStorage.setItem(search_history.key,JSON.stringify(search_history.storage)))}}catch{}},displaySearchHistory:function(){try{var e=$("li",search_history.holder);search_history.getLength()>0?(search_history.holder.show(),e.removeClass("active"),$(search_history.holder).css({width:$("#search-bar").width()+"px",height:$("#searchHistoryHolder ul.as-list").height()+2+"px"})):search_history.holder.hide()}catch{}},moveSelection:function(e){try{if(search_history.holder.is(":visible")){var t,n,i,o=$("li",search_history.holder),s=o.filter(".as-result-item, .as-result-item active");e=="down"?t=s.eq(0):t=s.filter(":last"),n=$("li.active:first",search_history.holder),n.length>0&&(e=="down"?(t=n.next(),t.index()<n.last().index()&&$(search_history.ul).scrollTop(1)):(t=n.prev(),t.length==0&&(t=s.filter(":last")))),o.removeClass("active"),t.addClass("active"),t.find("a")[0]?(i=t.find("a").text(),$("input.headerSearchBox").val(i),search_history.last_active_row=t):$("input.headerSearchBox").val("")}}catch{}},removeFromSearchHistory:function(e){try{var s,n=$("#searchLi"+e+" a").text(),t=search_history.storage.searchTerm.indexOf(n);t<0&&(t=search_history.storage.searchTerm.indexOf(HtmlEncodeString(n))),t>-1&&(search_history.storage.searchTerm.splice(t,1),localStorage.setItem(search_history.key,JSON.stringify(search_history.storage)),s=$("#searchLi"+e),s.remove(),search_history.displaySearchHistory())}catch{}},getLength:function(){try{return JSON.parse(localStorage.getItem(search_history.key)).searchTerm.length}catch{return 0}}};function ScrubEncodeSearchTerm(e){if(shIsEmptyOrNull(e))return e;var t=StripFromStringCaseInsensitive(e,"<script>"),t=StripFromStringCaseInsensitive(t,"<\/script>"),t=HtmlEncodeString(t);return t}function StripFromStringCaseInsensitive(e,t){if(!shIsEmptyOrNull(e)&&!shIsEmptyOrNull(t))for(;~e.toLocaleLowerCase().indexOf(t);){var n=e.toLowerCase().indexOf(t);e=e.replace(e.substring(n,n+t.length),"").trim()}return e}function HtmlEncodeString(e){return shIsEmptyOrNull(e)||(e=$("<div />").text(e).html()),e}$(function(){search_history.header.find("span").attr("aria-label",SH_HEADER).text(SH_HEADER),search_history.holder.hide(),search_history.ul.append(search_history.header),search_history.holder.append(search_history.ul),sh_search_bar.append(search_history.holder),search_history.loadSearchHistory(),search_history.populateSearchHistoryList(),sh_header_search_box.on("click",function(){try{if(sh_header_search_box.val().length==0&&(search_history.displaySearchHistory(),search_history.category_val=$("input[name=ScopeSelection]",sh_search_bar).val(),search_history.category=sh_search_bar.find("[data-value='"+search_history.category_val+"']").attr("eng"),CLICK_SEARCH_BOX_GA_FLAG&&!search_history.initial_search_box_click)){var e=search_history.getLength()>0?"Search History Shown":"Search History Empty";GaEventCustom("Search Box Clicked","Top",e,search_history.getLength(),{dimension57:"Top|"+search_history.category}),search_history.initial_search_box_click=!0}}catch{}}).on("keydown",function(e){try{switch(e.keyCode){case 38:e.preventDefault(),!search_history.initial_arrow_key_press&&search_history.getLength()>0&&(GaEvent("Search History Prefill",search_history.getLength().toString(),search_history.getLength().toString(),search_history.getLength()),search_history.initial_arrow_key_press=!0),search_history.arrow_key_pressed=!0,search_history.moveSelection("up");break;case 40:e.preventDefault(),!search_history.initial_arrow_key_press&&search_history.getLength()>0&&(GaEvent("Search History Prefill",search_history.getLength().toString(),search_history.getLength().toString(),search_history.getLength()),search_history.initial_arrow_key_press=!0),search_history.arrow_key_pressed=!0,search_history.moveSelection("down");break;case 13:if(search_history.holder.is(":visible")){var t=$("li.active:first",search_history.holder);t.length>0&&(e.preventDefault(),t.find("a").length>0&&(search_history.enter_key_pressed=!0,GaEvent("Search History Click Enter",t.find("a").text(),t.index().toString(),t.index()),t.trigger("click")),search_history.holder.hide())}break;default:e.keyCode==8?search_history.backspace_key_pressed=!0:(e.keyCode>47&&e.keyCode<58||e.keyCode==32||e.keyCode>64&&e.keyCode<91||e.keyCode>95&&e.keyCode<112||e.keyCode>185&&e.keyCode<193||e.keyCode>218&&e.keyCode<223)&&(search_history.printable_key_pressed=!0);break}}catch{}}),$("input.headerSearchBox").on("input propertychange",function(){try{shIsEmptyOrNull(this.value)?(search_history.displaySearchHistory(),search_history.printable_key_pressed=!1,search_history.arrow_key_pressed=!1,search_history.backspace_key_pressed=!1):search_history.holder.hide()}catch{}}),$(".form-control-clear",sh_search_bar).on("click",function(){setTimeout(function(){search_history.displaySearchHistory()},2),search_history.printable_key_pressed=!1,search_history.arrow_key_pressed=!1,search_history.backspace_key_pressed=!1}),$("[id^='searchLi']",search_history.holder).on("mouseover",function(){try{search_history.ul.find(".active").removeClass("active"),$(this).addClass("active")}catch{}}),$("[id^='searchLi']",search_history.holder).on("click",function(){try{search_history.row_clicked=!0;var t=$(this).find("a").text(),n=$(this).index();search_history.enter_key_pressed||GaEvent("Search History Clicked",t,n.toString(),n),$("input.headerSearchBox").val(t),search_history.addToSearchHistory(t,!1),$("#hdrSrch",sh_search_bar).trigger("click")}catch{}}),$("[id^='removeSearchItem']",search_history.holder).on("click",function(e){try{e.stopPropagation();var s=this.id.substring(16),n=$(this).parent().find("a").text(),t=$(this).parent().index();GaEvent("Search History Cleared",n,t.toString(),t),search_history.removeFromSearchHistory(s)}catch{}}),$(".remove-search-item").css({top:"0",right:"0","z-index":"2",display:"block",width:"32px",height:"32px","text-align":"center",position:"relative","font-size":"13px","margin-top":"-2px"}),$("input.headerSearchBox").on("keydown",function(e){e.keyCode==13&&(search_history.enter_on_textbox_pressed=!0)}),$("#hdrSrch",sh_search_bar).on("click",function(){try{if(!search_history.row_clicked){if(!search_history.enter_on_textbox_pressed&&(search_history.category_val=$("input[name=ScopeSelection]",sh_search_bar).val(),search_history.category=sh_search_bar.find("[data-value='"+search_history.category_val+"']").attr("eng"),CLICK_SEARCH_BUTTON_GA_FLAG)){var e,t=search_history.getLength()>0?"Search History Shown":"Search History Empty";GaEventCustom("Search Button Clicked","Top",t,search_history.getLength(),{dimension57:"Top|"+search_history.category})}e=sh_header_search_box.val(),shIsEmptyOrNull(e)||(e=e.trim(),search_history.addToSearchHistory(e,!0)),search_history.arrow_key_pressed&&(search_history.printable_key_pressed||search_history.backspace_key_pressed)&&!shIsEmptyOrNull(e)&&typeof search_history.last_active_row!="undefined"&&GaEvent("Search History Prefill Modified Search",e,search_history.last_active_row.index().toString(),search_history.last_active_row.index())}}catch{}}),$(window).on("resize",function(){$(search_history.holder).css({width:$("#search-bar").width()+"px"});var e=$("#search-bar").width()-40;$("[id^='searchLi'] > a ").css({display:"inline-block",width:e+"px",overflow:"hidden","text-overflow":"ellipsis"})})});function shGenerateRandNums(e){var n,t=[];do{do n=Math.floor(Math.random()*100);while(t.some(function(e){return e==n}))t.push(n)}while(t.length<e)return t}function shIsEmptyOrNull(e){return e==null||e.length===0}function shEqualsIgnoreCase(e,t){return e.toUpperCase()===t.toUpperCase()}