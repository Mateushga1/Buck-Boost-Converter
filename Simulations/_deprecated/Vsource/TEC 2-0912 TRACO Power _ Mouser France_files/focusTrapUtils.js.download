var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,s,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},__assign.apply(this,arguments)},asyncModalControl={},modalContainer=[],ASYNC_EVENT_CONTENTLOADED="modal:loaded",ASYNC_EVENT_MODALREADY="async:modal:ready",EVENT_MODALSHOWN="shown.bs.modal",EVENT_MODALHIDDEN="hidden.bs.modal",EVENT_FOCUSTRAP="keydown",FOCUSTRAP_FOCUSABLE_ELEMENTS_SELECTOR='button:visible, [href], a[href], area[href], input:not([disabled]):not([type="hidden"]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function AsnycModalShownEventHandler(e){var t=$(e.target).data("key");asyncModalControl[t].isModalShown=!0,DetermineAsyncModalReady(t)&&$(e.target).trigger(ASYNC_EVENT_MODALREADY,t)}function AsyncModalContentLoadedEventHandler(e,t){asyncModalControl[t].isContentLoaded=!0,DetermineAsyncModalReady(t)&&$(e.target).trigger(ASYNC_EVENT_MODALREADY,t)}function AsyncModalReadyEventHandler(e,t){var n=$(e.target).find(FOCUSTRAP_FOCUSABLE_ELEMENTS_SELECTOR);modalContainer.push({modal:$(e.target),asyncModalKey:t,firstFocusableEl:n[0],lastFocusableEl:n[n.length-1],lastFocusedElement:$(asyncModalControl[t].triggerElementSelector)}),n&&n.length>0&&n[0].focus()}function AsyncModalClosedEventHandler(){ResetAsyncModalControls();var t=modalContainer.pop();t.lastFocusedElement&&typeof t.lastFocusedElement!="undefined"&&t.lastFocusedElement.focus()}function AsyncModalFocusTrap(e){var t,n=9;if(modalContainer.length>0)switch(t=modalContainer[modalContainer.length-1],e.keyCode){case n:e.shiftKey?document.activeElement===t.firstFocusableEl&&(e.preventDefault(),t.lastFocusableEl.focus()):document.activeElement===t.lastFocusableEl&&(e.preventDefault(),t.firstFocusableEl.focus());break}}function DetermineAsyncModalReady(e){return asyncModalControl[e].isModalShown&&asyncModalControl[e].isContentLoaded}function ResetAsyncModalControls(){Object.keys(asyncModalControl).forEach(function(e){asyncModalControl[e].isModalShown=!1,asyncModalControl[e].isContentLoaded=!1})}function BindAsyncModalFocusTrap(e,t,n){var s,o;asyncModalControl[n]={isContentLoaded:!1,isModalShown:!1,triggerElementSelector:t},e&&n&&($(e).on(EVENT_MODALSHOWN,AsnycModalShownEventHandler),$(e).on(ASYNC_EVENT_CONTENTLOADED,AsyncModalContentLoadedEventHandler),$(e).on(ASYNC_EVENT_MODALREADY,AsyncModalReadyEventHandler),$(e).on(EVENT_MODALHIDDEN,AsyncModalClosedEventHandler),$(e).on(EVENT_FOCUSTRAP,AsyncModalFocusTrap))}function RefreshAsyncModalFocusTrap(e,t){var n=$(e).find(FOCUSTRAP_FOCUSABLE_ELEMENTS_SELECTOR),s=FindIndexByField(modalContainer,"asyncModalKey",t);s>=0&&(modalContainer[s]=__assign(__assign({},modalContainer[s]),{firstFocusableEl:n[0],lastFocusableEl:n[n.length-1]}),n&&n.length>0&&n[0].focus())}function FindIndexByField(e,t,n){for(var s=0;s<e.length;s++)if(e[s][t]===n)return s;return-1}